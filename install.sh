#!/bin/env bash
if [[ $UID != 0 ]]; then
    echo "You need to be root to install all features" >&2
    exit 1
fi

# Installation of binaries
for bin_file in $(ls -A ./pentest-assistants/); do
    cp ./pentest-assistants/$bin_file /bin/ || echo "./pentest-assistants/${bin_file} was not copied"
done

# bash completions for binaries
for bash_comp_file in $(ls -A ./bash-completions/); do
    cp ./bash-completions/$bash_comp_file /etc/bash_completion.d/$bash_comp_file || echo "./bash-completions/${bash_comp_file} was not copied"
done

# fish completions for binaries
for fish_comp_file in $(ls -A ./fish-completions/); do
    cp ./fish-completions/$fish_comp_file /etc/fish/completions/$fish_comp_file || echo "./fish-completions/${fish_comp_file} was not copied"
done

# Installation of dotfiles for root
for dot_file in $(ls -A ./dotfiles/); do
    cp ./dotfiles/$dot_file ~/ || echo "./dotfiles/${dot_file} was not copied"
done

available_users=$(ls -A /home)
for username in $available_users; do
    # Installation of dotfiles for all users
    if [[ -d /home/$username/ ]]; then
        for dotfile in $(ls -A ./dotfiles/); do
            cp ./dotfiles/$dotfile /home/$username/
        done
    fi
done

exit 0
