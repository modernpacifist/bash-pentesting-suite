#!/bin/env bash
if [[ $UID != 0 ]]; then
    echo "You need to be root to install all features" >&2
    exit 1
fi

# Installation of binaries
for bin_file in $(ls -A ./pentest-assistants/); do
    cp ./pentest-assistants/$bin_file /bin/ || echo "./pentest-assistants/${bin_file} was not copied"
done

# Completions for binaries
for comp_file in $(ls -A ./completions/); do
    cp ./completions/$comp_file /etc/bash_completion.d/$comp_file || echo "./completions/${comp_file} was not copied"
done

# Installation of dotfiles for root
for dot_file in $(ls -A ./dotfiles/); do
    cp ./dotfiles/$dot_file ~/ || echo "./dotfiles/${dot_file} was not copied"
done

available_users=$(ls -A /home)
for username in $available_users; do
    # Installation of dotfiles for all users
    if [[ -d /home/$username/ ]]; then
        for dotfile in $(ls -A ./dotfiles/); do
            cp ./dotfiles/$dotfile /home/$username/
        done
    fi
done

exit 0
