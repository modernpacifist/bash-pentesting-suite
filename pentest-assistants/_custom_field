#!/bin/env bash
values_dotfile="$HOME/.tmp_values.json"

while getopts ":k:v:" opt; do
    case $opt in
        k) [[ -z ${OPTARG} ]] && exit 1 || key=${OPTARG} ;;
        v) [[ -z ${OPTARG} ]] && exit 1 || value=${OPTARG} ;;
        \?) echo "Invalid option -$OPTARG" >&2;;
    esac
done

if [[ ! -f $values_dotfile ]]; then
    echo "{ }" | jq '.' > ${values_dotfile}
fi

# this rewrites the file in all cases
m_json=$(jq ".${key} = \"${value}\"" $values_dotfile)
echo $m_json | jq '.' > $values_dotfile
